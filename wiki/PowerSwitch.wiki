== Introduction: ==
I would like to be able to turn on/off PC by just switching on/off the button on power extension cord with switch:

http://upload.wikimedia.org/wikipedia/commons/thumb/b/b6/Socket_5.jpg/640px-Socket_5.jpg

Turning on is simple - just switch on the power extension switch ! 

The issue is with turning off - all PCs needs some time to shut down properly 
This idea is similar to the way how UPS communicates with PC in case of power failure.

== General concept: ==
 * arduino will be used as central unit:
http://upload.wikimedia.org/wikipedia/commons/thumb/9/9d/UnoConnections.jpg/640px-UnoConnections.jpg
 *  arduino will control the relay module which will power PC
 * arduino will be connected to mains by power adapter and to PC with USB
 * power cord switch will switch on/off the arduino power adapter and not the PC
 *  arduino will auto-select the power source between power adapter and USB

== How does it work ? ==
= Turning PC on:=
 * switch on arduino's power adapter
 * arduino starts and by default sets relay in ON mode and PC boots up

= Turning PC off (this is tricky part)=
 * switch off arduino's adapter using button on extension cord
 * arduino switches itself to USB power source using built into board auto-select functionality
 * arduino "senses" that power adaptor is switched off
 * arduino sends message over USB to PC ordering PC to enter shut down sequence
 * arduino goes into sleep for the time needed for PC to shut down
 * arduino wakes up (at this point PC is already down)
 * arduino sets relay to OFF mode

== Implementation details: ==
There are 3 elements which had to be implemented:
 * software:
  * listener on PC to intercept the shut down message from arduino
  * software running on micro controller to monitor current power source
 * hardware:
  * device to monitor power source for arduino
  * relay to drive power for PC

 

== Links ==
http://arduino.cc/forum/index.php?topic=134390.0